mode: Rule
log-level: info
#geox-url:
#  geoip: https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat
#  geosite: https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat
hosts:
  dns.alidns.com: [223.5.5.5, 223.6.6.6]
  doh.pub: [1.12.12.12, 1.12.12.21, 120.53.53.53]
  dns.google: [8.8.8.8, 8.8.4.4]
  cloudflare-dns.com: [1.1.1.1, 1.0.0.1]
dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:1053
  fake-ip-range: 28.0.0.1/8
  enhanced-mode: redir-host
  fake-ip-filter: [+.*]
  respect-rules: true
  nameserver:
    - 223.5.5.5
    - 114.114.114.114
  proxy-server-nameserver:
    - https://dns.google/dns-query
    - https://cloudflare-dns.com/dns-query

  nameserver-policy:
    "+.gdtel.com": 
      - 132.121.218.164
    "+.ctc.com": 
      - 132.121.218.164
    rule-set:local:
      - 223.5.5.5
      - 114.114.114.114
    rule-set:formula1,other,us:
      - 8.8.8.8
      - 1.1.1.1
    geosite:gfw,github,google,youtube,bing,category-android-app-download,tiktok,yahoo,yahoo@cn:
      - 8.8.8.8
      - 1.1.1.1
    geosite:cn: 223.5.5.5
  geosite:
    path: ./geosite.dat
    download:
      url: https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat
      interval: 86400
  geoip:
    path: ./geoip.dat
    download:
      url: https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat
      interval: 86400

sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.google.com"
    - "+.formula1.com"
    - "geosite:jd"
    - "geosite:category-bank-cn"
  skip-domain:
    - "*.lan"
    - "*.local"

#自定义DNS使用的rule-set    
rule-providers:
  formula1:
    type: http
    interval: 1800
    behavior: classical
    format: yaml
    url: http://subcon.44224422.xyz:5547/https://raw.githubusercontent.com/HH3456/own/refs/heads/main/metasub/f1.list
    path: ./ruleset/formula1.yaml
  other:
    type: http
    interval: 1800
    behavior: classical
    format: yaml
    url: http://subcon.44224422.xyz:5547/https://raw.githubusercontent.com/HH3456/own/refs/heads/main/metasub/other.list
    path: ./ruleset/other.yaml
  local:
    type: http
    interval: 1800
    behavior: classical
    format: yaml
    url: http://subcon.44224422.xyz:5547/https://raw.githubusercontent.com/HH3456/own/refs/heads/main/metasub/local.list
    path: ./ruleset/local.yaml
  us:
    type: http
    interval: 1800
    behavior: classical
    format: yaml
    url: http://subcon.44224422.xyz:5547/https://raw.githubusercontent.com/HH3456/own/refs/heads/main/metasub/us.list
    path: ./ruleset/us.yaml
  geoip-cn:
    type: http
    interval: 1800
    behavior: ipcidr
    format: mrs
    url: https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo-lite/geoip/cn.mrs
    path: ./ruleset/cn.mrs
  

